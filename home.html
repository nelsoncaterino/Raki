<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mafalda - Bon Anniversaire Pouleto!</title>
<link href="https://fonts.googleapis.com/css2?family=Bangers&family=Comic+Neue:wght@400;700&display=swap" rel="stylesheet">
<style>
  /* NOUVELLES COULEURS AMBIANCE BD */
  :root {
    --rose: #e9cae69a; /* Un jaune lÃ©gÃ¨rement plus chaud et vintage */
    --red:    #D32F2F; /* Le rouge classique de la robe de Mafalda */
    --blue:   #5DADE2; /* Un bleu plus doux */
    --dark:   #1a1a1a; /* Encre noire */
    --white:  #FDFEFE;
    --green:  #27ae60;
  }
  
  * { margin:0; padding:0; box-sizing:border-box; }
  body {
    background: var(--rose);
    font-family: 'Comic Neue', cursive;
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* CONFETTI */
  .confetti-bg { position:fixed; top:0; left:0; right:0; bottom:0; pointer-events:none; z-index:0; overflow:hidden; }
  .confetto    { position:absolute; border-radius:2px; animation:fall linear infinite; opacity:0.75; }
  @keyframes fall {
    0%   { transform:translateY(-20px) rotate(0deg);   opacity:1; }
    100% { transform:translateY(110vh) rotate(720deg); opacity:0; }
  }

  /* LAYOUT */
  .container {
    position:relative; z-index:1;
    max-width:860px; margin:0 auto; padding:20px;
    min-height:100vh; display:flex; flex-direction:column;
    align-items:center; gap:20px;
  }

  /* TITRE */
  .title-banner {
    background:var(--red); border:4px solid var(--dark);
    border-radius:16px; padding:14px 40px;
    box-shadow:6px 6px 0 var(--dark); transform:rotate(-1.5deg); margin-top:10px;
  }
  .title-banner h1 {
    font-family:'Bangers',cursive; font-size:clamp(2rem,6vw,3.6rem);
    color:var(--white); letter-spacing:3px; text-shadow:3px 3px 0 var(--dark); text-align:center;
  }

  /* VOICE PICKER */
  .voice-picker {
    display:flex; align-items:center; gap:8px; flex-wrap:wrap; justify-content:center;
  }
  .voice-label {
    font-family:'Bangers',cursive; font-size:1rem; letter-spacing:1px;
    color:var(--dark); opacity:0.7;
  }
  .voice-btn {
    font-family:'Comic Neue',cursive; font-weight:700; font-size:0.82rem;
    padding:6px 14px; border:3px solid var(--dark); border-radius:20px;
    cursor:pointer; background:var(--white); color:var(--dark);
    box-shadow:3px 3px 0 var(--dark); transition:all 0.12s;
  }
  .voice-btn:hover  { transform:translate(-1px,-1px); box-shadow:5px 5px 0 var(--dark); }
  .voice-btn:active { transform:translate(1px,1px);   box-shadow:2px 2px 0 var(--dark); }
  .voice-btn.active { background:var(--blue); color:white; }

  /* SCENE */
  .scene {
    display:flex; align-items:flex-end;
    position:relative; width:100%; max-width:680px;
  }
  
  /* NOUVEAU STYLE POUR L'IMAGE DE MAFALDA */
  .mafalda-wrap { flex-shrink:0; width:210px; position:relative; z-index:2; }
  .mafalda-wrap img {
    width: 100%;
    height: auto;
    display: block;
    filter: drop-shadow(4px 4px 0px var(--dark)); /* Ombre style BD */
  }
  .mafalda-wrap.talking { animation:bounce 0.35s ease infinite alternate; }
  @keyframes bounce { from{transform:translateY(0)} to{transform:translateY(-9px)} }

  .bubble {
    position:relative; background:var(--white);
    border:4px solid var(--dark); border-radius:20px;
    padding:22px 26px; flex:1; margin-bottom:40px;
    box-shadow:5px 5px 0 var(--dark); min-height:120px;
    display:flex; flex-direction:column; justify-content:center; gap:8px;
  }
  .bubble::before {
    content:''; position:absolute; left:-28px; bottom:28px;
    width:0; height:0;
    border-top:14px solid transparent; border-bottom:14px solid transparent; border-right:28px solid var(--dark);
  }
  .bubble::after {
    content:''; position:absolute; left:-20px; bottom:30px;
    width:0; height:0;
    border-top:12px solid transparent; border-bottom:12px solid transparent; border-right:24px solid var(--white);
  }
  .message-text {
    font-family:'Comic Neue',cursive; font-weight:700;
    font-size:clamp(1.2rem,3.5vw,2rem); color:var(--dark); line-height:1.3;
  }
  .lang-row {
    font-size:clamp(0.75rem,2vw,0.95rem); color:var(--blue);
    font-weight:700; font-style:italic;
    display:flex; align-items:center; gap:6px;
  }
  .speaking-dot {
    width:9px; height:9px; border-radius:50%; background:var(--green);
    flex-shrink:0; opacity:0; transition:opacity 0.25s;
    animation:pulse 0.55s ease-in-out infinite alternate;
  }
  .speaking-dot.on { opacity:1; }
  @keyframes pulse { from{transform:scale(1)} to{transform:scale(1.7)} }

  .pop-in { animation:popIn 0.4s cubic-bezier(0.175,0.885,0.32,1.275) both; }
  @keyframes popIn {
    0%   { opacity:0; transform:scale(0.7) translateY(-10px); }
    100% { opacity:1; transform:scale(1) translateY(0); }
  }

  /* GROS BOUTON */
  .big-random-btn {
    font-family:'Bangers',cursive;
    font-size:clamp(1.5rem,4vw,2.2rem);
    letter-spacing:2px; padding:18px 52px;
    border:5px solid var(--dark); border-radius:20px;
    cursor:pointer; background:var(--red); color:var(--white);
    box-shadow:7px 7px 0 var(--dark); transition:all 0.12s;
    text-shadow:2px 2px 0 rgba(0,0,0,0.3);
    position:relative; overflow:hidden;
  }
  .big-random-btn::after {
    content:''; position:absolute; top:0; left:-100%; width:60%; height:100%;
    background:linear-gradient(90deg,transparent,rgba(255,255,255,0.25),transparent);
    transition:left 0.4s;
  }
  .big-random-btn:hover  { transform:translate(-3px,-3px); box-shadow:10px 10px 0 var(--dark); }
  .big-random-btn:hover::after { left:150%; }
  .big-random-btn:active { transform:translate(3px,3px); box-shadow:4px 4px 0 var(--dark); }

  .counter { font-family:'Bangers',cursive; font-size:1rem; color:var(--dark); opacity:0.5; letter-spacing:2px; min-height:1.2em; }

  .star-burst { position:absolute; font-size:1.5rem; animation:spin 4s linear infinite; pointer-events:none; }
  @keyframes spin { from{transform:rotate(0deg)} to{transform:rotate(360deg)} }

  footer { font-family:'Comic Neue',cursive; font-size:0.78rem; color:#555; padding-bottom:24px; text-align:center; margin-top:auto; }
</style>
</head>
<body>

<div class="confetti-bg" id="confettiBg"></div>

<div class="container">

  <div class="title-banner">
    <h1>ğŸ‚ Joyeux Anniversaire Pouleto! ğŸ‰</h1>
  </div>

  <div class="voice-picker">
    <span class="voice-label">ğŸ™ï¸ Voix :</span>
    <button class="voice-btn active" onclick="setVoice(this,'jsCqWAovK2LkecY7zXl4')">Freya</button>
    <button class="voice-btn" onclick="setVoice(this,'pFZP5JQG7iQjIQuC4Bku')">Lily</button>
    <button class="voice-btn" onclick="setVoice(this,'XB0fDUnXU5powFXDhCwa')">Charlotte</button>
    <button class="voice-btn" onclick="setVoice(this,'cgSgspJ2msm6clMCkdW9')">Jessica</button>
    <button class="voice-btn" onclick="setVoice(this,'FGY2WhTYpPnrIDTdsKH5')">Laura</button>
  </div>

  <div class="scene">
    <span class="star-burst" style="top:-10px;right:16px">â­</span>
    <span class="star-burst" style="top:14px;right:54px;animation-duration:2.8s;font-size:1rem">âœ¨</span>

    <div class="mafalda-wrap" id="mafaldaWrap">
      <img src="mafalda.png" alt="Mafalda">
    </div>

    <div class="bubble">
      <div class="message-text" id="msgText">Bon anniversaire Pouleto !</div>
      <div class="lang-row">
        <span class="speaking-dot" id="speakDot"></span>
        <span id="langTag">(FranÃ§ais)</span>
      </div>
    </div>
  </div>

  <button class="big-random-btn" onclick="randomLang()">
    ğŸ² Une autre langue !
  </button>
  <div class="counter" id="counter"></div>

  <footer>Fait avec â¤ï¸ pour Pouleto â€” inspirÃ© de Mafalda par Quino</footer>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  âš™ï¸  CONFIG â€” modifie ici ta clÃ© et ta voix par dÃ©faut
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const API_KEY         = '5da6c5e5fc5f849e1cdb6886aee4056d3fdf49099bf7fc1e4954d04965174b7e';   // â† colle ta clÃ© ElevenLabs
let   voiceId         = 'jsCqWAovK2LkecY7zXl4'; // voix par dÃ©faut : Freya

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  MESSAGES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const messages = [
  { msg:"Bon anniversaire Pouleto !",                       lang:"FranÃ§ais",               code:"fr" },
  { msg:"Happy birthday Pouleto!",                          lang:"English",                code:"en" },
  { msg:"Buon compleanno Pouleto!",                         lang:"Italiano",               code:"it" },
  { msg:"Â¡Feliz cumpleaÃ±os Pouleto!",                       lang:"EspaÃ±ol",                code:"es" },
  { msg:"Alles Gute zum Geburtstag Pouleto!",               lang:"Deutsch",                code:"de" },
  { msg:"Feliz aniversÃ¡rio Pouleto!",                       lang:"PortuguÃªs",              code:"pt" },
  { msg:"Ğ¡ Ğ´Ğ½Ñ‘Ğ¼ Ñ€Ğ¾Ğ¶Ğ´ĞµĞ½Ğ¸Ñ, ĞŸÑƒĞ»ĞµÑ‚Ğ¾!",                         lang:"Ğ ÑƒÑÑĞºĞ¸Ğ¹",                code:"ru" },
  { msg:"ç”Ÿæ—¥å¿«ä¹ï¼Œæ™®è±æ‰˜ï¼",                                   lang:"ä¸­æ–‡ (Mandarin)",          code:"zh" },
  { msg:"Pouleto ãŠèª•ç”Ÿæ—¥ãŠã‚ã§ã¨ã†ï¼",                        lang:"æ—¥æœ¬èª",                    code:"ja" },
  { msg:"ìƒì¼ ì¶•í•˜í•´, í’€ë ˆí† !",                                 lang:"í•œêµ­ì–´",                   code:"ko" },
  { msg:"Ø¹ÙŠØ¯ Ù…ÙŠÙ„Ø§Ø¯ Ø³Ø¹ÙŠØ¯ ÙŠØ§ Ø¨ÙˆÙ„ÙŠØªÙˆ!",                        lang:"Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",                 code:"ar" },
  { msg:"Gelukkige verjaardag Pouleto!",                    lang:"Nederlands",             code:"nl" },
  { msg:"Grattis pÃ¥ fÃ¶delsedagen Pouleto!",                 lang:"Svenska",                code:"sv" },
  { msg:"Tillykke med fÃ¸dselsdagen Pouleto!",               lang:"Dansk",                  code:"da" },
  { msg:"HyvÃ¤Ã¤ syntymÃ¤pÃ¤ivÃ¤Ã¤ Pouleto!",                     lang:"Suomi",                  code:"fi" },
  { msg:"Boldog szÃ¼letÃ©snapot Pouleto!",                    lang:"Magyar",                 code:"hu" },
  { msg:"Wszystkiego najlepszego Pouleto!",                 lang:"Polski",                 code:"pl" },
  { msg:"Ä°yi ki doÄŸdun Pouleto!",                           lang:"TÃ¼rkÃ§e",                 code:"tr" },
  { msg:"ChÃºc má»«ng sinh nháº­t Pouleto!",                     lang:"Tiáº¿ng Viá»‡t",             code:"vi" },
  { msg:"!×™×•× ×”×•×œ×“×ª ×©××— ×¤×•×œ×˜×•",                             lang:"×¢×‘×¨×™×ª",                   code:"he" },
  { msg:"à¤œà¤¨à¥à¤®à¤¦à¤¿à¤¨ à¤®à¥à¤¬à¤¾à¤°à¤• à¤¹à¥‹ à¤ªà¥‚à¤²à¥‡à¤¤à¥‹!",                       lang:"à¤¹à¤¿à¤¨à¥à¤¦à¥€",                  code:"hi" },
  { msg:"à¦¶à§à¦­ à¦œà¦¨à§à¦®à¦¦à¦¿à¦¨ à¦ªà§à¦²à§‡à¦¤à§‹!",                              lang:"à¦¬à¦¾à¦‚à¦²à¦¾",                   code:"bn" },
  { msg:"Selamat ulang tahun Pouleto!",                     lang:"Bahasa Indonesia",       code:"id" },
  { msg:"Maligayang Bati Pouleto!",                         lang:"Filipino",               code:"fil"},
  { msg:"Bon anniversari Pouleto!",                         lang:"Catalan",                code:"ca" },
  { msg:"Ğ¡ Ğ”Ğ½ĞµĞ¼ Ğ½Ğ°Ñ€Ğ¾Ğ´Ğ¶ĞµĞ½Ğ½Ñ, ĞŸÑƒĞ»ĞµÑ‚Ğ¾!",                       lang:"Ğ£ĞºÑ€Ğ°Ñ—Ğ½ÑÑŒĞºĞ°",             code:"uk" },
  { msg:"Sretan roÄ‘endan Pouleto!",                         lang:"Hrvatski",               code:"hr" },
  { msg:"VÅ¡echno nejlepÅ¡Ã­ Pouleto!",                        lang:"ÄŒeÅ¡tina",                code:"cs" },
  { msg:"áƒ’áƒ˜áƒšáƒáƒªáƒáƒ• áƒ“áƒáƒ‘áƒáƒ“áƒ”áƒ‘áƒ˜áƒ¡ áƒ“áƒ¦áƒ”áƒ¡ áƒáƒ£áƒšáƒ”áƒ¢áƒ!",                 lang:"áƒ¥áƒáƒ áƒ—áƒ£áƒšáƒ˜",                code:"ka" },
  { msg:"Õ‡Õ¶Õ¸Ö€Õ°Õ¡Õ¾Õ¸Ö€ Õ®Õ¶Õ¸Ö‚Õ¶Õ¤Õ¤ Pouleto!",                       lang:"Õ€Õ¡ÕµÕ¥Ö€Õ¥Õ¶",                 code:"hy" },
  { msg:"ØªÙˆÙ„Ø¯Øª Ù…Ø¨Ø§Ø±Ú© Ù¾ÙˆÙ„ØªÙˆ!",                               lang:"ÙØ§Ø±Ø³ÛŒ",                   code:"fa" },
  { msg:"Hongera Pouleto!",                                 lang:"Swahili",                code:"sw" },
  { msg:"Â¡Feliz cumple Pouleto!",                           lang:"EspaÃ±ol argentino ğŸ‡¦ğŸ‡·",   code:"es" },
  { msg:"Feliz aniversÃ¡rio Pouleto!",                       lang:"PortuguÃªs Brasil ğŸ‡§ğŸ‡·",    code:"pt" },
  { msg:"Veseli rojstni dan Pouleto!",                      lang:"SlovenÅ¡Äina",            code:"sl" },
  { msg:"LaimingÅ³ gimtadienio Pouleto!",                    lang:"LietuviÅ³",               code:"lt" },
  { msg:"Daudz laimes dzimÅ¡anas dienÄ Pouleto!",            lang:"LatvieÅ¡u",               code:"lv" },
  { msg:"Gelukkige verjaarsdag Pouleto!",                   lang:"Afrikaans",              code:"af" },
  { msg:"Gut Gebuersdag Pouleto!",                          lang:"Luxembourgeois",         code:"lb" },
  { msg:"Bloavez mat Pouleto!",                             lang:"Breton",                 code:"br" },
  { msg:"Joyeux anniversaire Pouleto !",                    lang:"FranÃ§ais belge ğŸ‡§ğŸ‡ª",       code:"fr" },
  { msg:"Bon anivÃ¨sÃ¨ Pouleto!",                             lang:"CrÃ©ole rÃ©unionnais",      code:"fr" },
  { msg:"à®ªà®¿à®±à®¨à¯à®¤à®¨à®¾à®³à¯ à®µà®¾à®´à¯à®¤à¯à®¤à¯à®•à¯à®•à®³à¯ à®ªà¯à®²à¯‡à®Ÿà¯à®Ÿà¯‹!",             lang:"à®¤à®®à®¿à®´à¯",                   code:"ta" },
  { msg:"Sve najbolje Pouleto!",                            lang:"Srpski",                 code:"sr" },
  { msg:"Å Å¥astnÃ½ narodeniny Pouleto!",                      lang:"SlovenÄina",             code:"sk" },
  { msg:"Joyeux anniversaire Pouleto !",                    lang:"Occitan",                code:"fr" },
  { msg:"Bonne fÃªte Pouleto !",                             lang:"FranÃ§ais quÃ©bÃ©cois ğŸ‡¨ğŸ‡¦",   code:"fr" },
  { msg:"Herzlichen GlÃ¼ckwunsch Pouleto!",                  lang:"Deutsch (formel)",       code:"de" },
  { msg:"Feliz aniversario Pouleto!",                       lang:"Galicien",               code:"gl" },
  { msg:"Sai hannun haihuwa Pouleto!",                      lang:"Hausa",                  code:"ha" },
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let current      = 0;
let currentAudio = null;
let lastPicked   = new Set([0]);

const msgTextEl   = document.getElementById('msgText');
const langTagEl   = document.getElementById('langTag');
const counterEl   = document.getElementById('counter');
const speakDot    = document.getElementById('speakDot');
const mafaldaWrap = document.getElementById('mafaldaWrap');

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  VOICE PICKER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function setVoice(btn, id) {
  voiceId = id;
  document.querySelectorAll('.voice-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  WEB SPEECH FALLBACK
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let wsVoices = [];
function loadWSVoices() { wsVoices = window.speechSynthesis?.getVoices() || []; }
loadWSVoices();
if (window.speechSynthesis?.onvoiceschanged !== undefined)
  window.speechSynthesis.onvoiceschanged = loadWSVoices;

const localeMap = {
  fr:'fr-FR', en:'en-US', it:'it-IT', es:'es-ES', de:'de-DE', pt:'pt-PT',
  ru:'ru-RU', zh:'zh-CN', ja:'ja-JP', ko:'ko-KR', ar:'ar-SA', nl:'nl-NL',
  sv:'sv-SE', da:'da-DK', fi:'fi-FI', hu:'hu-HU', pl:'pl-PL', tr:'tr-TR',
  vi:'vi-VN', he:'he-IL', hi:'hi-IN', bn:'bn-BD', ta:'ta-IN', af:'af-ZA',
  id:'id-ID', fil:'fil-PH', ca:'ca-ES', uk:'uk-UA', sr:'sr-RS', hr:'hr-HR',
  cs:'cs-CZ', sk:'sk-SK', ka:'ka-GE', hy:'hy-AM', fa:'fa-IR', sw:'sw-KE',
  sl:'sl-SI', lb:'de-LU', br:'fr-FR', lt:'lt-LT', lv:'lv-LV', gl:'gl-ES',
};

function speakWS(text, code) {
  if (!window.speechSynthesis) return;
  window.speechSynthesis.cancel();
  const utter  = new SpeechSynthesisUtterance(text);
  const locale = localeMap[code] || 'fr-FR';
  utter.lang   = locale;
  utter.pitch  = 1.8;
  utter.rate   = 1.0;
  let voice = wsVoices.find(v => v.lang === locale);
  if (!voice) voice = wsVoices.find(v => v.lang.startsWith(code));
  if (voice) utter.voice = voice;
  utter.onstart = () => setSpeaking(true);
  utter.onend   = () => setSpeaking(false);
  window.speechSynthesis.speak(utter);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ELEVENLABS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function speakEL(text, code) {
  stopAudio();
  setSpeaking(true);
  try {
    const res = await fetch(`https://api.elevenlabs.io/v1/text-to-speech/${voiceId}`, {
      method:'POST', mode:'cors',
      headers:{ 'xi-api-key': API_KEY, 'Content-Type':'application/json', 'Accept':'audio/mpeg' },
      body: JSON.stringify({
        text,
        model_id: 'eleven_multilingual_v2',
        voice_settings:{ stability:0.40, similarity_boost:0.78, style:0.30, use_speaker_boost:true }
      })
    });
    if (!res.ok) throw new Error('EL ' + res.status);
    const blob = await res.blob();
    const url  = URL.createObjectURL(blob);
    currentAudio = new Audio(url);
    currentAudio.onended = () => { setSpeaking(false); URL.revokeObjectURL(url); };
    currentAudio.onerror = () => setSpeaking(false);
    currentAudio.play();
  } catch(e) {
    console.warn('EL fallback:', e.message);
    setSpeaking(false);
    speakWS(text, code);
  }
}

function stopAudio() {
  if (currentAudio) { currentAudio.pause(); currentAudio = null; }
  if (window.speechSynthesis) window.speechSynthesis.cancel();
  setSpeaking(false);
}

function setSpeaking(on) {
  speakDot.classList.toggle('on', on);
  mafaldaWrap.classList.toggle('talking', on);
}

function speak(text, code) {
  const key = API_KEY.trim();
  if (key && key !== 'METS_TA_CLE_ICI') speakEL(text, code);
  else speakWS(text, code);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  RANDOM LANG
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function randomLang() {
  if (lastPicked.size >= messages.length) lastPicked = new Set([current]);
  let idx;
  do { idx = Math.floor(Math.random() * messages.length); }
  while (lastPicked.has(idx));
  lastPicked.add(idx);
  current = idx;

  const m = messages[current];

  msgTextEl.classList.remove('pop-in');
  langTagEl.classList.remove('pop-in');
  void msgTextEl.offsetWidth;
  msgTextEl.classList.add('pop-in');
  langTagEl.classList.add('pop-in');

  msgTextEl.textContent = m.msg;
  langTagEl.textContent = '(' + m.lang + ')';
  counterEl.textContent = lastPicked.size + ' / ' + messages.length + ' langues dÃ©couvertes';

  speak(m.msg, m.code);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
msgTextEl.textContent = messages[0].msg;
langTagEl.textContent = '(FranÃ§ais)';

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  CONFETTI
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const colors = ['#D32F2F','#5DADE2','#F4D03F','#FF69B4','#7CFC00','#FF8C00','#FDFEFE','#9B59B6'];
const bg = document.getElementById('confettiBg');
for (let i = 0; i < 50; i++) {
  const c = document.createElement('div');
  c.className = 'confetto';
  c.style.left   = Math.random() * 100 + '%';
  c.style.top    = (Math.random() * 100 - 20) + '%';
  c.style.background = colors[Math.floor(Math.random() * colors.length)];
  c.style.animationDuration = (3 + Math.random() * 7) + 's';
  c.style.animationDelay    = (Math.random() * 6) + 's';
  c.style.width  = (5 + Math.random() * 10) + 'px';
  c.style.height = (7 + Math.random() * 14) + 'px';
  c.style.transform = `rotate(${Math.random()*360}deg)`;
  bg.appendChild(c);
}
</script>
</body>
</html>